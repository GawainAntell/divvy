<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Rarefy localities within latitudinal bands — bandit • divvy</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Rarefy localities within latitudinal bands — bandit"><meta name="description" content="bandit subsamples spatial point data to a specified number of sites
within bins of equal latitude"><meta property="og:description" content="bandit subsamples spatial point data to a specified number of sites
within bins of equal latitude"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">divvy</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-getting-started" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Getting started</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-getting-started"><li><a class="dropdown-item" href="../articles/subsampling-vignette.html">Subsampling tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/habitat-rangesize-case-study.html">Range size case study</a></li>
    <li><a class="dropdown-item" href="../articles/subsampling-concept-walkthrough.html">Conceptual walkthrough</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/GawainAntell/divvy/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Rarefy localities within latitudinal bands</h1>
      <small class="dont-index">Source: <a href="https://github.com/GawainAntell/divvy/blob/main/R/subsample_lat_band.R" class="external-link"><code>R/subsample_lat_band.R</code></a></small>
      <div class="d-none name"><code>bandit.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>bandit</code> subsamples spatial point data to a specified number of sites
within bins of equal latitude</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bandit</span><span class="op">(</span></span>
<span>  <span class="va">dat</span>,</span>
<span>  <span class="va">xy</span>,</span>
<span>  <span class="va">iter</span>,</span>
<span>  <span class="va">nSite</span>,</span>
<span>  <span class="va">bin</span>,</span>
<span>  centr <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  absLat <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  maxN <span class="op">=</span> <span class="fl">90</span>,</span>
<span>  maxS <span class="op">=</span> <span class="op">-</span><span class="fl">90</span>,</span>
<span>  crs <span class="op">=</span> <span class="st">"epsg:4326"</span>,</span>
<span>  output <span class="op">=</span> <span class="st">"locs"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dat">dat<a class="anchor" aria-label="anchor" href="#arg-dat"></a></dt>
<dd><p>A <code>data.frame</code> or <code>matrix</code> containing the coordinate
columns <code>xy</code> and any associated variables, e.g. taxon names.</p></dd>


<dt id="arg-xy">xy<a class="anchor" aria-label="anchor" href="#arg-xy"></a></dt>
<dd><p>A vector of two elements, specifying the name or numeric position
of columns in <code>dat</code> containing coordinates, e.g. longitude and latitude.
Coordinates for any shared sampling sites should be identical, and where sites
are raster cells, coordinates are usually expected to be cell centroids.</p></dd>


<dt id="arg-iter">iter<a class="anchor" aria-label="anchor" href="#arg-iter"></a></dt>
<dd><p>The number of times to subsample localities within <strong>each</strong>
latitudinal band.</p></dd>


<dt id="arg-nsite">nSite<a class="anchor" aria-label="anchor" href="#arg-nsite"></a></dt>
<dd><p>The quota of unique locations to include in each subsample.</p></dd>


<dt id="arg-bin">bin<a class="anchor" aria-label="anchor" href="#arg-bin"></a></dt>
<dd><p>A positive numeric value for latitudinal band width, in degrees.</p></dd>


<dt id="arg-centr">centr<a class="anchor" aria-label="anchor" href="#arg-centr"></a></dt>
<dd><p>Logical: should a bin center on and cover the equator
(<code>TRUE</code>) or should the equator mark the boundary between the
lowest-latitude northern and southern bins (<code>FALSE</code>, default)?
Ignored if <code>absLat = TRUE</code>.</p></dd>


<dt id="arg-abslat">absLat<a class="anchor" aria-label="anchor" href="#arg-abslat"></a></dt>
<dd><p>Logical: should only the absolute values of latitude be
evaluated? If <code>absLat = TRUE</code>, <code>centr</code> argument is ignored.</p></dd>


<dt id="arg-maxn">maxN<a class="anchor" aria-label="anchor" href="#arg-maxn"></a></dt>
<dd><p>Optional argument to specify the northmost limit for subsampling,
if less than 90 degrees.</p></dd>


<dt id="arg-maxs">maxS<a class="anchor" aria-label="anchor" href="#arg-maxs"></a></dt>
<dd><p>Optional argument to specify the southmost limit for subsampling,
if not -90 degrees. Should be a negative value if in the southern hemisphere.</p></dd>


<dt id="arg-crs">crs<a class="anchor" aria-label="anchor" href="#arg-crs"></a></dt>
<dd><p>Coordinate reference system as a GDAL text string, EPSG code,
or object of class <code>crs</code>. Default is latitude-longitude (<code>EPSG:4326</code>).</p></dd>


<dt id="arg-output">output<a class="anchor" aria-label="anchor" href="#arg-output"></a></dt>
<dd><p>Whether the returned data should be two columns of
subsample site coordinates (<code>output = 'locs'</code>) or the subset of rows
from <code>dat</code> associated with those coordinates (<code>output = 'full'</code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of subsamples, each a <code>data.frame</code> containing
coordinates of subsampled localities (if <code>output = 'locs'</code>)
or the subset of occurrences from <code>dat</code> associated with those coordinates
(if <code>output = 'full'</code>). The latitudinal bounds of each subsample
are specified by its name in the list. If there are too few localities
in a given interval to draw a subsample, that interval is omitted from output.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>bandit()</code> rarefies the number of spatial sites within latitudinal ranges
of specified bin width. (Compare with <code><a href="cookies.html">cookies()</a></code> and <code><a href="clustr.html">clustr()</a></code>, which spatially
subsample to a specified extent without regard to latitudinal position.)
Cases where it could be appropriate to control for latitudinal spread of localities
include characterisations of latitudinal diversity gradients (e.g. Marcot 2016)
or comparisons of ecosystem parameters that covary strongly with
latitude (e.g. diversity in reefal vs. non-reefal habitats). Note that
the total surface area of the Earth within equal-latitudinal increments
decreases from the equator towards the poles; <code>bandit()</code> standardises only
the amount of sites/area encompassed by each subsample, not the total area
that could have been available for species to inhabit.</p>
<p>As with all <code>divvy</code> subsampling functions, sites within a given
regional/latitudinal subsample are selected without replacement.</p>
<p>To calculate an integer number of degrees into which a given latitudinal
range divides evenly, the <code>palaeoverse</code> package (v 1.2.1) provides the
<code>palaeoverse::lat_bins()</code> function with argument <code>fit = TRUE</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Allen2020divvy</p>
<p>Marcot2016divvy</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="cookies.html">cookies()</a></code></p>
<p><code><a href="clustr.html">clustr()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># load bivalve occurrences to rasterise</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> terra 1.8.42</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">bivalves</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># initialise Equal Earth projected coordinates</span></span></span>
<span class="r-in"><span><span class="va">rWorld</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">prj</span> <span class="op">&lt;-</span> <span class="st">'EPSG:8857'</span></span></span>
<span class="r-in"><span><span class="va">rPrj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/project.html" class="external-link">project</a></span><span class="op">(</span><span class="va">rWorld</span>, <span class="va">prj</span>, res <span class="op">=</span> <span class="fl">200000</span><span class="op">)</span> <span class="co"># 200,000m is approximately 2 degrees</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># coordinate column names for the current and target coordinate reference system</span></span></span>
<span class="r-in"><span><span class="va">xyCartes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'paleolng'</span>,<span class="st">'paleolat'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xyCell</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'centroidX'</span>,<span class="st">'centroidY'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># project occurrences and retrieve cell centroids in new coordinate system</span></span></span>
<span class="r-in"><span><span class="va">llOccs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/vect.html" class="external-link">vect</a></span><span class="op">(</span><span class="va">bivalves</span>, geom <span class="op">=</span> <span class="va">xyCartes</span>, crs <span class="op">=</span> <span class="st">'epsg:4326'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">prjOccs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/project.html" class="external-link">project</a></span><span class="op">(</span><span class="va">llOccs</span>, <span class="va">prj</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cellIds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/cells.html" class="external-link">cells</a></span><span class="op">(</span><span class="va">rPrj</span>, <span class="va">prjOccs</span><span class="op">)</span><span class="op">[</span>,<span class="st">'cell'</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">bivalves</span><span class="op">[</span>, <span class="va">xyCell</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/xyCellFrom.html" class="external-link">xyFromCell</a></span><span class="op">(</span><span class="va">rPrj</span>, <span class="va">cellIds</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># subsample 20 equal-area sites within 10-degree bands of absolute latitude</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">20</span></span></span>
<span class="r-in"><span><span class="va">reps</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">11</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bandAbs</span> <span class="op">&lt;-</span> <span class="fu">bandit</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">bivalves</span>, xy <span class="op">=</span> <span class="va">xyCell</span>,</span></span>
<span class="r-in"><span>                  iter <span class="op">=</span> <span class="va">reps</span>, nSite <span class="op">=</span> <span class="va">n</span>, output <span class="op">=</span> <span class="st">'full'</span>,</span></span>
<span class="r-in"><span>                  bin <span class="op">=</span> <span class="fl">10</span>, absLat <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                  crs <span class="op">=</span> <span class="va">prj</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">bandAbs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co"># inspect first subsample</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       genus paleolng paleolat collection_no reference_no    environment max_ma</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61 Placamen   122.84    12.21         41525        11125 coastal indet.  5.333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62  Anadara   122.84    12.21         41524        11125 coastal indet.  5.333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63  Anadara   122.84    12.21         41524        11125 coastal indet.  5.333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64  Anadara   122.84    12.21         41524        11125 coastal indet.  5.333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65  Corbula   122.84    12.21         41524        11125 coastal indet.  5.333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66  Corbula   122.84    12.21         41524        11125 coastal indet.  5.333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    min_ma                      accepted_name centroidX centroidY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61  2.588                           Placamen  11656041   1539440</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62  2.588        Anadara (Anadara) antiquata  11656041   1539440</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63  2.588         Anadara (Anadara) biformis  11656041   1539440</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64  2.588                            Anadara  11656041   1539440</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65  2.588 Corbula (Notocorbula) fortisulcata  11656041   1539440</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66  2.588                            Corbula  11656041   1539440</span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bandAbs</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="co"># degree interval (absolute value) of first subsample</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "[10,20)"</span>
<span class="r-in"><span><span class="co">#&gt; [1] "[10,20)"</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bandAbs</span><span class="op">)</span><span class="op">)</span> <span class="co"># all intervals containing sufficient data</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "[10,20)" "[20,30)" "[30,40)" "[40,50)"</span>
<span class="r-in"><span><span class="co">#&gt; [1] "[10,20)" "[20,30)" "[30,40)" "[40,50)"</span></span></span>
<span class="r-in"><span><span class="co"># note insufficient coverage to subsample at equator or above 50 degrees</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># subsample 20-degree bands, where central band spans the equator</span></span></span>
<span class="r-in"><span><span class="co"># (-10 S to 10 N latitude), as in Allen et al. (2020)</span></span></span>
<span class="r-in"><span><span class="co"># (An alternative, finer-grain way to divide 180 degrees evenly into an</span></span></span>
<span class="r-in"><span><span class="co"># odd number of bands would be to set 'bin' = 4.)</span></span></span>
<span class="r-in"><span><span class="va">bandCent</span> <span class="op">&lt;-</span> <span class="fu">bandit</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">bivalves</span>, xy <span class="op">=</span> <span class="va">xyCell</span>,</span></span>
<span class="r-in"><span>                   iter <span class="op">=</span> <span class="va">reps</span>, nSite <span class="op">=</span> <span class="va">n</span>, output <span class="op">=</span> <span class="st">'full'</span>,</span></span>
<span class="r-in"><span>                   bin <span class="op">=</span> <span class="fl">20</span>, centr <span class="op">=</span> <span class="cn">TRUE</span>, absLat <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                   crs <span class="op">=</span> <span class="va">prj</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bandCent</span><span class="op">)</span><span class="op">)</span> <span class="co"># all intervals containing sufficient data</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "[-50,-30)" "[10,30)"   "[30,50)"  </span>
<span class="r-in"><span><span class="co">#&gt; [1] "[-50,-30)" "[10,30)" "[30,50)"</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gawain Antell.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

